{"version":3,"file":"assets/lambda/js/chunks/form-field-GridSelector.3c1f2f7e54a68dfd.js","mappings":"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","sources":["webpack:///node_modules/@lambda-platform/lambda-builder/src/modules/dataform/elements/GridSelector.vue","webpack:///./node_modules/@lambda-platform/lambda-builder/src/modules/dataform/elements/GridSelector.vue?8e58","webpack:///./node_modules/@lambda-platform/lambda-builder/src/modules/dataform/elements/GridSelector.vue","webpack:///./node_modules/@lambda-platform/lambda-builder/src/modules/dataform/elements/GridSelector.vue?6747"],"sourcesContent":["<template>\n    <div class=\"subform-grid\">\n        <FormItem :label=label :prop=rule>\n            <div class=\"subform-header\" >\n                {{ meta.GSOption.sourceGridModalTitle }}\n\n            </div>\n            <table border=\"1\" >\n                <thead>\n                <tr>\n\n                    <th v-for=\"item in meta.GSOption.sourceGridTargetColumns\"\n                        :key=\"item.index\">\n                        {{ item.label }}\n                    </th>\n                    <th class=\"action\">...</th>\n                </tr>\n                </thead>\n                <tbody>\n                <tr>\n\n                    <td v-for=\"item in meta.GSOption.sourceGridTargetColumns\"\n                        :key=\"item.index\">\n                        {{selectedRow[item.model]}}\n                    </td>\n                    <td class=\"action\">\n                        <a href=\"javascript:void(0);\" @click=\"showAddSourceModal\" v-if=\"!meta.disabled\">\n                            <Icon type=\"md-search\" />\n                        </a>\n                    </td>\n                </tr>\n                </tbody>\n            </table>\n        </FormItem>\n\n        <paper-modal\n            :name=\"`grid-modal-${meta.GSOption.sourceGridID}`\"\n            class=\"form-modal\"\n            :min-width=\"200\"\n            :min-height=\"100\"\n            :pivot-y=\"0.5\"\n            :adaptive=\"true\"\n            :reset=\"true\"\n            :draggable=\"true\"\n            :resizable=\"true\"\n            draggable=\".form-tool\"\n            width=\"800\"\n            height=\"70%\"\n        >\n            <section class=\"form-modal source-grid\">\n                <div class=\"form-tool \">\n\n                    <h4>{{ meta.GSOption.sourceGridModalTitle }}</h4>\n                    <div class=\"form-tool-actions\">\n                        <a href=\"javascript:void(0)\" @click=\"closeSourceModal\">\n                            <i class=\"ti-close\"></i>\n                        </a>\n                    </div>\n                </div>\n\n                <div class=\"form-body\" v-if=\"modal_grid_show\">\n\n                    <div v-if=\"meta.GSOption.sourceGridTitle && meta.GSOption.sourceGridDescription\" class=\"source-grid-description\">\n                        <h3>\n                            {{meta.GSOption.sourceGridTitle}}\n                        </h3>\n                        <p v-html=\"meta.GSOption.sourceGridDescription\">\n\n                        </p>\n                    </div>\n                    <datagrid\n                        :schemaID=\"meta.GSOption.sourceGridID\"\n                        :url=\"sourceGridUrl()\"\n                        :onRowSelect=\"onRowSelect\"\n                        :paginate=\"50\"\n                        :hasSelection=\"true\"\n                        :gridSelector=\"true\"\n                        :user_condition=\"user_condition\"\n                        :permissions=\"{\n                          c:false,\n                          r:true,\n                          u:false,\n                          d:false,\n                      }\"\n                    />\n                    <div class=\"add-from-pre-source\">\n                        <Button shape=\"circle\" type=\"success\" size=\"small\" @click=\"addFromPreSource\" :disabled=\"preSource.length == 0\" icon=\"md-add\"\n                                class=\"sub-form-add-btn\">Сонгох</Button>\n                    </div>\n                </div>\n            </section>\n        </paper-modal>\n    </div>\n</template>\n\n<script>\n\nexport default {\n    props: [\"model\", \"rule\", \"label\", \"meta\"],\n    data() {\n        return {\n            preSource:[],\n            modal_grid_show: false,\n            user_condition:null,\n            selectedRow:{}\n        };\n    },\n\n    computed: {\n        value() {\n            return this.model.form[this.model.component];\n\n\n        },\n    },\n\n    watch: {\n        value(value, oldValue){\n            if(this.value === null || this.value === 0 || this.value === \"\"){\n                this.selectedRow = {}\n            }\n            if (value && !oldValue){\n                if(Object.keys(this.selectedRow).length ==0){\n                  this.callRowData();\n                }\n\n            }\n        }\n    },\n\n    mounted() {\n        if(this.meta.GSOption.sourceGridUserCondition !== undefined && this.meta.GSOption.sourceGridUserCondition !== null && this.meta.GSOption.sourceGridUserCondition != \"\"){\n            this.user_condition = JSON.parse(this.meta.GSOption.sourceGridUserCondition)\n        }\n    },\n\n    methods: {\n        callRowData(){\n\n            let filter = {}\n\n            filter[this.meta.GSOption.sourceGridValueField] = this.value;\n\n            axios.post(`${this.sourceGridUrl()}/lambda/puzzle/grid/data/${this.meta.GSOption.sourceGridID}?&paginate=1&page=1&sort=id&order=desc`, filter).then(({data})=>{\n\n               if(data.data.length >= 1){\n                   this.selectedRow = data.data[0];\n               }\n\n            })\n        },\n        onRowSelect(rows){\n            this.preSource = rows;\n        },\n        sourceGridUrl(){\n\n            if(window.init.microserviceSettings) {\n                let si = window.init.microserviceSettings.findIndex(set=>set.project_id == this.meta.GSOption.sourceMicroserviceID);\n\n                if(si >= 0){\n                    return  window.init.microserviceSettings[si].production_url;\n                } else {\n                    return \"\"\n                }\n            } else {\n                return \"\"\n            }\n        },\n        showAddSourceModal() {\n            this.modal_grid_show = true;\n            this.$modal.show(`grid-modal-${this.meta.GSOption.sourceGridID}`);\n        },\n        closeSourceModal() {\n            this.modal_grid_show = false;\n            this.$modal.hide(`grid-modal-${this.meta.GSOption.sourceGridID}`);\n        },\n        addFromPreSource(){\n            this.selectedRow = {}\n            if(this.preSource && this.meta.GSOption.sourceGridTargetColumns){\n                if(this.preSource.length >= 1){\n                    this.selectedRow = this.preSource[0];\n\n                    this.model.form[this.model.component] = this.selectedRow[this.meta.GSOption.sourceGridValueField]\n                }\n\n            }\n            this.closeSourceModal();\n\n        },\n\n    }\n};\n</script>\n\n\n","import mod from \"-!../../../../../../vue-loader/lib/index.js??vue-loader-options!./GridSelector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../vue-loader/lib/index.js??vue-loader-options!./GridSelector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GridSelector.vue?vue&type=template&id=00d6cc6e&\"\nimport script from \"./GridSelector.vue?vue&type=script&lang=js&\"\nexport * from \"./GridSelector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"subform-grid\"},[_c('FormItem',{attrs:{\"label\":_vm.label,\"prop\":_vm.rule}},[_c('div',{staticClass:\"subform-header\"},[_vm._v(\"\\n            \"+_vm._s(_vm.meta.GSOption.sourceGridModalTitle)+\"\\n\\n        \")]),_vm._v(\" \"),_c('table',{attrs:{\"border\":\"1\"}},[_c('thead',[_c('tr',[_vm._l((_vm.meta.GSOption.sourceGridTargetColumns),function(item){return _c('th',{key:item.index},[_vm._v(\"\\n                    \"+_vm._s(item.label)+\"\\n                \")])}),_vm._v(\" \"),_c('th',{staticClass:\"action\"},[_vm._v(\"...\")])],2)]),_vm._v(\" \"),_c('tbody',[_c('tr',[_vm._l((_vm.meta.GSOption.sourceGridTargetColumns),function(item){return _c('td',{key:item.index},[_vm._v(\"\\n                    \"+_vm._s(_vm.selectedRow[item.model])+\"\\n                \")])}),_vm._v(\" \"),_c('td',{staticClass:\"action\"},[(!_vm.meta.disabled)?_c('a',{attrs:{\"href\":\"javascript:void(0);\"},on:{\"click\":_vm.showAddSourceModal}},[_c('Icon',{attrs:{\"type\":\"md-search\"}})],1):_vm._e()])],2)])])]),_vm._v(\" \"),_c('paper-modal',{staticClass:\"form-modal\",attrs:{\"name\":(\"grid-modal-\" + (_vm.meta.GSOption.sourceGridID)),\"min-width\":200,\"min-height\":100,\"pivot-y\":0.5,\"adaptive\":true,\"reset\":true,\"draggable\":true,\"resizable\":true,\"draggable\":\".form-tool\",\"width\":\"800\",\"height\":\"70%\"}},[_c('section',{staticClass:\"form-modal source-grid\"},[_c('div',{staticClass:\"form-tool \"},[_c('h4',[_vm._v(_vm._s(_vm.meta.GSOption.sourceGridModalTitle))]),_vm._v(\" \"),_c('div',{staticClass:\"form-tool-actions\"},[_c('a',{attrs:{\"href\":\"javascript:void(0)\"},on:{\"click\":_vm.closeSourceModal}},[_c('i',{staticClass:\"ti-close\"})])])]),_vm._v(\" \"),(_vm.modal_grid_show)?_c('div',{staticClass:\"form-body\"},[(_vm.meta.GSOption.sourceGridTitle && _vm.meta.GSOption.sourceGridDescription)?_c('div',{staticClass:\"source-grid-description\"},[_c('h3',[_vm._v(\"\\n                        \"+_vm._s(_vm.meta.GSOption.sourceGridTitle)+\"\\n                    \")]),_vm._v(\" \"),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.meta.GSOption.sourceGridDescription)}})]):_vm._e(),_vm._v(\" \"),_c('datagrid',{attrs:{\"schemaID\":_vm.meta.GSOption.sourceGridID,\"url\":_vm.sourceGridUrl(),\"onRowSelect\":_vm.onRowSelect,\"paginate\":50,\"hasSelection\":true,\"gridSelector\":true,\"user_condition\":_vm.user_condition,\"permissions\":{\n                      c:false,\n                      r:true,\n                      u:false,\n                      d:false,\n                  }}}),_vm._v(\" \"),_c('div',{staticClass:\"add-from-pre-source\"},[_c('Button',{staticClass:\"sub-form-add-btn\",attrs:{\"shape\":\"circle\",\"type\":\"success\",\"size\":\"small\",\"disabled\":_vm.preSource.length == 0,\"icon\":\"md-add\"},on:{\"click\":_vm.addFromPreSource}},[_vm._v(\"Сонгох\")])],1)],1):_vm._e()])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"names":["props","data","preSource","modal_grid_show","user_condition","selectedRow","computed","value","this","model","form","component","watch","oldValue","Object","keys","length","callRowData","mounted","undefined","meta","GSOption","sourceGridUserCondition","JSON","parse","methods","filter","sourceGridValueField","axios","post","sourceGridUrl","sourceGridID","then","onRowSelect","rows","window","init","microserviceSettings","si","findIndex","set","project_id","sourceMicroserviceID","production_url","showAddSourceModal","$modal","show","closeSourceModal","hide","addFromPreSource","sourceGridTargetColumns","_vm","_h","$createElement","_c","_self","staticClass","attrs","label","rule","_v","_s","sourceGridModalTitle","_l","item","key","index","disabled","_e","on","sourceGridTitle","sourceGridDescription","domProps","c","r","u","d"],"sourceRoot":""}