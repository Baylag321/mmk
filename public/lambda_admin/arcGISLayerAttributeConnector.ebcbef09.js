import{m as I}from"./_mixin.6266d507.js";import{a as k,r as a,o as p,e as _,f as l,w as s,h as e,N as A,c as x,k as h,i as c}from"./entry.fff4ff4b.js";const J={mixins:[I],data(){return{gisAttribute:null,formField:null,columns:[{title:"ArcGIS \u0430\u0442\u0440\u0438\u0431\u0443\u0442",dataIndex:"attribute",key:"attribute"},{title:"\u041C\u0430\u044F\u0433\u0442\u044B\u043D \u0442\u0430\u043B\u0431\u0430\u0440",dataIndex:"field",key:"field"},{title:"operation",dataIndex:"operation"}],connections:[],objectIdField:null,geoJsonField:null,layerType:null}},methods:{remove(n){this.connections.splice(n,1),this.saveData()},addConnection(){this.gisAttribute&&this.formField&&(this.connections.push({attribute:this.gisAttribute,field:this.formField}),this.gisAttribute=null,this.formField=null,this.saveData())},saveData(){this.model.form[this.model.component]=JSON.stringify({connections:this.connections,objectIdField:this.objectIdField,geoJsonField:this.geoJsonField,layerType:this.layerType})}},created(){},mounted(){this.model.form[this.model.component]},computed:{gisAttributes(){return this.meta.gis_options?this.meta.gis_options:[]},connectionValue(){return this.model.form[this.model.component]}},watch:{connectionValue(n,t){if((t&&!n||n&&!t)&&n){let r=JSON.parse(this.model.form[this.model.component]);this.connections=r.connections,this.objectIdField=r.objectIdField,this.geoJsonField=r.geoJsonField,this.layerType=r.layerType}}}},T=e("div",null,[e("label",null,"\u0413\u0430\u0437\u0430\u0440 \u0437\u04AF\u0439\u043D \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0438\u0439\u043D \u0442\u04E9\u0440\u04E9\u043B:")],-1),j=c("Point"),w=c("Polygon"),D=c("Polyline"),N=e("hr",null,null,-1),S=e("br",null,null,-1),P=e("label",null,"OBJECTID \u0445\u0430\u0434\u0433\u0430\u043B\u043B\u0430\u0445 \u0442\u0430\u043B\u0431\u0430\u0440 (\u041C\u0430\u044F\u0433\u0442\u044B\u043D)",-1),B=e("label",null,"\u0413\u0430\u0437\u0430\u0440\u0437\u04AF\u0439\u043D \u043C\u044D\u0434\u044D\u044D\u043B\u043B\u0438\u0439\u043D \u0442\u0430\u043B\u0431\u0430\u0440 (\u041C\u0430\u044F\u0433\u0442\u044B\u043D)",-1),U=e("br",null,null,-1),V=e("hr",null,null,-1),G=e("br",null,null,-1),O=e("label",null,"ArcGIS \u0430\u0442\u0440\u0438\u0431\u0443\u0442",-1),E=e("label",null,"\u041C\u0430\u044F\u0433\u0442\u044B\u043D \u0442\u0430\u043B\u0431\u0430\u0440",-1),L=e("br",null,null,-1),q=c("\u041D\u044D\u043C\u044D\u0445"),z=e("a",null,"\u0423\u0442\u0433\u0430\u0445",-1);function H(n,t,r,K,o,d){const b=a("lambda-form-item"),m=a("a-radio"),f=a("a-radio-group"),u=a("a-select"),v=a("a-button"),y=a("a-popconfirm"),g=a("a-table");return p(),_("div",null,[l(b,{label:n.label,name:n.model.component,meta:n.meta},{default:s(()=>[T]),_:1},8,["label","name","meta"]),l(f,{value:o.layerType,"onUpdate:value":t[0]||(t[0]=i=>o.layerType=i),onChange:d.saveData},{default:s(()=>[l(m,{value:"Point"},{default:s(()=>[j]),_:1}),l(m,{value:"Polygon"},{default:s(()=>[w]),_:1}),l(m,{value:"Polyline"},{default:s(()=>[D]),_:1})]),_:1},8,["value","onChange"]),N,S,e("div",null,[P,l(u,{value:o.objectIdField,"onUpdate:value":t[1]||(t[1]=i=>o.objectIdField=i),style:{width:"200px"},onChange:d.saveData,options:n.meta.options},null,8,["value","onChange","options"])]),e("div",null,[B,l(u,{value:o.geoJsonField,"onUpdate:value":t[2]||(t[2]=i=>o.geoJsonField=i),style:{width:"200px"},onChange:d.saveData,options:n.meta.options},null,8,["value","onChange","options"])]),U,V,e("div",null,[G,e("table",null,[e("tr",null,[e("td",null,[O,l(u,{value:o.gisAttribute,"onUpdate:value":t[3]||(t[3]=i=>o.gisAttribute=i),style:{width:"100%"},options:d.gisAttributes},null,8,["value","options"])]),e("td",null,[E,l(u,{value:o.formField,"onUpdate:value":t[4]||(t[4]=i=>o.formField=i),style:{width:"100%"},options:n.meta.options},null,8,["value","options"])]),e("td",null,[L,l(v,{type:"primary",onClick:d.addConnection},{default:s(()=>[q]),_:1},8,["onClick"])])])]),l(g,{border:"",columns:o.columns,dataSource:o.connections},{bodyCell:s(({text:i,record:M,index:F,column:C})=>[C.dataIndex==="operation"?(p(),_(A,{key:0},[o.connections.length?(p(),x(y,{key:0,title:"\u0423\u0442\u0433\u0430\u0445 \u0443\u0443?","ok-text":"\u0422\u0438\u0439\u043C","cancel-text":"\u04AE\u0433\u04AF\u0439",onConfirm:Q=>d.remove(F)},{default:s(()=>[z]),_:2},1032,["onConfirm"])):h("",!0)],64)):h("",!0)]),_:1},8,["columns","dataSource"])])])}const X=k(J,[["render",H]]);export{X as default};
