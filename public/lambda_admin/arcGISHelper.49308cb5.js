import{x as i,b as u,I as $}from"./entry.edf531c9.js";const s="https://dms.ulaanbaatar.mn/arcgis/rest/services/Manaikhoroo_II",f=async()=>{try{let o=await i.get(u+"/arcgis/token");if(o.data.token)return o.data.token.token;m()}catch{m()}},m=()=>{$.error("ArcGIS server \u0442\u044D\u0439 \u0445\u043E\u043B\u0431\u043E\u0433\u0434\u043E\u0436 \u0447\u0430\u0434\u0441\u0430\u043D\u0433\u04AF\u0439 !!!")},R=async()=>{let o=await f(),l=await i.get(`${s}?f=json&token=${o}`,{transformRequest:(a,t)=>{delete t.common["X-CSRF-TOKEN"],delete t["X-CSRF-TOKEN"],delete t.Authorization,delete t.common["X-Requested-With"],delete t.common.Authorization}}),n=[];if(l.data.folders.length>=1)l.data.folders.map(async(a,t)=>{let e={value:`${s}${a}`,label:a},r=await d(`${s}/${a}`,o);r.length>=1&&(e.children=r),n.push(e)});else{let a={value:`${s}`,label:"root"},t=await d(`${s}`,o);t.length>=1&&(a.children=t),n.push(a)}return{layers:n,token:o}},d=async(o,l)=>{let n=await i.get(`${o}?f=pjson&token=${l}`,{transformRequest:(t,e)=>{delete e.common["X-CSRF-TOKEN"],delete e["X-CSRF-TOKEN"],delete e.Authorization,delete e.common["X-Requested-With"],delete e.common.Authorization}}),a=[];if(n.data.services)for(const t of n.data.services){n.data.services.indexOf(t);let e=t.name.split("/");if(t.type==="FeatureServer"){let r=await p(`${o}/${e[1]}/${t.type}`,l),c={value:`${o}/${e[1]}/${t.type}`,label:`FeatureService - ${e[1]}`};r.length>=1&&(c.children=r),a.push(c)}else a.push({value:`${o}/${e[1]}/${t.type}`,label:`${t.type} - ${e[1]}`})}return a},p=async(o,l)=>{let n=await i.get(`${o}?f=pjson&token=${l}`,{transformRequest:(t,e)=>{delete e.common["X-CSRF-TOKEN"],delete e["X-CSRF-TOKEN"],delete e.Authorization,delete e.common["X-Requested-With"],delete e.common.Authorization}}),a=[];return n.data.layers.map((t,e)=>{a.push({value:`${o}/${e}`,label:t.name})}),a},g=async(o,l)=>await i.get(`${o}?f=pjson&token=${l}`,{transformRequest:(n,a)=>{delete a.common["X-CSRF-TOKEN"],delete a["X-CSRF-TOKEN"],delete a.Authorization,delete a.common["X-Requested-With"],delete a.common.Authorization}});export{g as L,R as g};
