import{m as be}from"./_mixin.6266d507.js";import{C as ve,aV as ke,aW as ge,aX as Z,aY as G,f as o,aZ as H,a_ as J,Z as m,a$ as l,b0 as _e,b1 as g,b2 as we,b3 as ye,b4 as xe,b5 as Y,b6 as X,b7 as T,b8 as Fe,b9 as Se,a as Ne,r as b,o as w,c as I,w as k,J as Te,h as V,k as A,e as Ie}from"./entry.fff4ff4b.js";function y(t){return typeof t=="function"?t():t}const Ae=ve({name:"ConfirmDialog",inheritAttrs:!1,props:["icon","onCancel","onOk","close","closable","zIndex","afterClose","visible","keyboard","centered","getContainer","maskStyle","okButtonProps","cancelButtonProps","okType","prefixCls","okCancel","width","mask","maskClosable","okText","cancelText","autoFocusButton","transitionName","maskTransitionName","type","title","content","direction","rootPrefixCls","bodyStyle","closeIcon","modalRender","focusTriggerAfterClose","wrapClassName"],setup:function(e,d){var a=d.attrs,i=ke("Modal"),u=ge(i,1),f=u[0];return function(){var p=e.icon,v=e.onCancel,_=e.onOk,r=e.close,n=e.closable,c=n===void 0?!1:n,s=e.zIndex,h=e.afterClose,F=e.visible,S=e.keyboard,B=e.centered,K=e.getContainer,Q=e.maskStyle,$=e.okButtonProps,ee=e.cancelButtonProps,O=e.okCancel,M=O===void 0?!0:O,E=e.width,te=E===void 0?416:E,R=e.mask,oe=R===void 0?!0:R,z=e.maskClosable,ne=z===void 0?!1:z,D=e.type,W=e.title,le=e.content,ae=e.direction,re=e.closeIcon,ie=e.modalRender,se=e.focusTriggerAfterClose,N=e.rootPrefixCls,ce=e.bodyStyle,ue=e.wrapClassName,de=e.okType||"primary",P=e.prefixCls||"ant-modal",C="".concat(P,"-confirm"),me=a.style||{},fe=y(e.okText)||(M?f.value.okText:f.value.justOkText),he=y(e.cancelText)||f.value.cancelText,j=e.autoFocusButton===null?!1:e.autoFocusButton||"ok",Ce=Z(C,"".concat(C,"-").concat(D),"".concat(P,"-").concat(D),G({},"".concat(C,"-rtl"),ae==="rtl"),a.class),pe=M&&o(H,{actionFn:v,close:r,autofocus:j==="cancel",buttonProps:ee,prefixCls:"".concat(N,"-btn")},{default:function(){return[he]}});return o(m,{prefixCls:P,class:Ce,wrapClassName:Z(G({},"".concat(C,"-centered"),!!B),ue),onCancel:function(U){return r({triggerCancel:!0},U)},visible:F,title:"",footer:"",transitionName:J(N,"zoom",e.transitionName),maskTransitionName:J(N,"fade",e.maskTransitionName),mask:oe,maskClosable:ne,maskStyle:Q,style:me,bodyStyle:ce,width:te,zIndex:s,afterClose:h,keyboard:S,centered:B,getContainer:K,closable:c,closeIcon:re,modalRender:ie,focusTriggerAfterClose:se},{default:function(){return[o("div",{class:"".concat(C,"-body-wrapper")},[o("div",{class:"".concat(C,"-body")},[y(p),W===void 0?null:o("span",{class:"".concat(C,"-title")},[y(W)]),o("div",{class:"".concat(C,"-content")},[y(le)])]),o("div",{class:"".concat(C,"-btns")},[pe,o(H,{type:de,actionFn:_,close:r,autofocus:j==="ok",buttonProps:$,prefixCls:"".concat(N,"-btn")},{default:function(){return[fe]}})])])]}})}}});var Pe=function(e){var d=document.createDocumentFragment(),a=l(l({},_e(e,["parentContext","appContext"])),{close:f,visible:!0}),i=null;function u(){i&&(X(null,d),i.component.update(),i=null);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];var s=n.some(function(S){return S&&S.triggerCancel});e.onCancel&&s&&e.onCancel.apply(e,n);for(var h=0;h<g.length;h++){var F=g[h];if(F===f){g.splice(h,1);break}}}function f(){for(var r=this,n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];a=l(l({},a),{visible:!1,afterClose:function(){typeof e.afterClose=="function"&&e.afterClose(),u.apply(r,c)}}),p(a)}function p(r){typeof r=="function"?a=r(a):a=l(l({},a),r),i&&(l(i.component.props,a),i.component.update())}var v=function(n){var c=Se,s=c.prefixCls,h=n.prefixCls||"".concat(s,"-modal");return o(Fe,T(T({},c),{},{notUpdateGlobalConfig:!0,prefixCls:s}),{default:function(){return[o(Ae,T(T({},n),{},{rootPrefixCls:s,prefixCls:h}),null)]}})};function _(r){var n=o(v,l({},r));return n.appContext=e.parentContext||e.appContext||n.appContext,X(n,d),n}return i=_(a),g.push(f),{destroy:f,update:p}};const x=Pe;function Ve(t){return l(l({icon:function(){return o(Y,null,null)},okCancel:!1},t),{type:"warning"})}function Be(t){return l(l({icon:function(){return o(we,null,null)},okCancel:!1},t),{type:"info"})}function Oe(t){return l(l({icon:function(){return o(ye,null,null)},okCancel:!1},t),{type:"success"})}function Me(t){return l(l({icon:function(){return o(xe,null,null)},okCancel:!1},t),{type:"error"})}function Ee(t){return l(l({icon:function(){return o(Y,null,null)},okCancel:!0},t),{type:"confirm"})}function q(t){return x(Ve(t))}m.info=function(e){return x(Be(e))};m.success=function(e){return x(Oe(e))};m.error=function(e){return x(Me(e))};m.warning=q;m.warn=q;m.confirm=function(e){return x(Ee(e))};m.destroyAll=function(){for(;g.length;){var e=g.pop();e&&e()}};m.install=function(t){return t.component(m.name,m),t};const Re={mixins:[be],components:{"a-modal":m},computed:{lang(){const t=["dataNotFound"];return t.reduce((e,d,a)=>(e[d]=this.$t("dataForm."+t[a]),e),{})},addAble(){return this.meta.relation.addAble&&this.meta.relation.addFrom},selectClass(){let t="";return this.meta.info_url&&this.model.form[this.model.component]&&(t=t+" with-info-caller "),this.addAble&&(t=t+" addable-select "),t}},data(){return{selectValue:null,modal_show:!1}},methods:{changeValue(t){t!=null?this.meta.relation.multiple===!0?this.model.form[this.model.component]=t.join(","):t===""?this.model.form[this.model.component]=null:isNaN(t)?this.model.form[this.model.component]=t:this.model.form[this.model.component]=t*1:this.model.form[this.model.component]=null},addFromUrl(){if(window.init)if(window.init.microserviceSettings){let t=window.init.microserviceSettings.findIndex(e=>e.project_id==this.meta.relation.addFromMicroservice);return t>=0?window.init.microserviceSettings[t].production_url:this.url}else return this.url;else return this.url},showAddModal(){this.modal_show=!0},closeModal(){this.modal_show=!1},onSuccess(t){let e=this.meta.relation.fields.map(a=>t[a]);e=e.join(", ");let d={value:t[this.meta.relation.key],label:e};this.meta.relation.parentFieldOfTable!==""&&this.meta.relation.parentFieldOfForm!==""&&(d.parent_value=t[this.meta.relation.parentFieldOfTable].toString()),this.relation_data(this.meta).push(d),this.closeModal()},onError(t){},showInfoModal(){this.model.form[this.model.component]&&window.showInformationModal(`${this.meta.info_url}${this.model.form[this.model.component]}`,this.meta.placeHolder)},search(t){console.log(t)},initialValue(t){this.model.form[this.model.component]?this.model.form[this.meta.relation.parentFieldOfForm]?t.findIndex(d=>d.value===this.model.form[this.model.component])>=0?this.setSelectValue():this.setNull():this.setSelectValue():this.setNull()},setSelectValue(){this.meta.relation.multiple===!0&&this.model.form[this.model.component]!==""?this.selectValue=this.model.form[this.model.component].split(",").map(t=>isNaN(t)?t:t*1):this.selectValue=this.model.form[this.model.component]},setNull(){this.meta.relation.multiple===!0?this.selectValue=[]:this.selectValue=null}},watch:{do_render(t){t||(this.value=null,this.clearAble=!1,this.ignoreChange=!1)}}},ze={class:"svg-icon"},De={class:"svg-icon"},We={key:0,class:"add-modal"},je={class:"add-body"};function Le(t,e,d,a,i,u){const f=b("a-select"),p=b("inline-svg"),v=b("a-button"),_=b("a-input-group"),r=b("dataform"),n=b("a-modal"),c=b("lambda-form-item");return w(),I(c,{label:t.label,name:t.model.component,meta:t.meta},{default:k(()=>[o(_,{compact:""},{default:k(()=>[o(f,{value:i.selectValue,"onUpdate:value":e[0]||(e[0]=s=>i.selectValue=s),disabled:t.disabled,autocomplete:"off",allowClear:"",showSearch:"",options:t.options,optionFilterProp:"label",optionLabelProp:"label",mode:t.meta.relation.multiple?"multiple":void 0,onChange:u.changeValue,placeholder:t.placeholder,class:Te(u.selectClass)},null,8,["value","disabled","options","mode","onChange","placeholder","class"]),u.addAble?(w(),I(v,{key:0,onClick:u.showAddModal},{icon:k(()=>[V("span",ze,[o(p,{src:"/assets/icons/duotune/general/gen041.svg"})])]),_:1},8,["onClick"])):A("",!0),t.meta.info_url&&t.model.form[t.model.component]?(w(),I(v,{key:1,onClick:u.showInfoModal},{icon:k(()=>[V("span",De,[o(p,{src:"/assets/icons/duotone/Code/Info-circle.svg"})])]),_:1},8,["onClick"])):A("",!0)]),_:1}),u.addAble?(w(),I(n,{key:0,"min-width":200,"min-height":100,draggable:!0,"footer-hide":!0,title:t.label,width:"800",height:"70%",visible:i.modal_show,"onUpdate:visible":e[1]||(e[1]=s=>i.modal_show=s)},{footer:k(()=>[]),default:k(()=>[i.modal_show?(w(),Ie("section",We,[V("div",je,[o(r,{ref:"form",schemaID:t.meta.relation.addFrom,editMode:!1,onSuccess:u.onSuccess,url:u.addFromUrl(),do_render:i.modal_show,onError:u.onError},null,8,["schemaID","onSuccess","url","do_render","onError"])])])):A("",!0)]),_:1},8,["title","visible"])):A("",!0)]),_:1},8,["label","name","meta"])}const Ge=Ne(Re,[["render",Le]]);export{Ge as default};
